{"ast":null,"code":"import axiosInstance from '../utils/axiosInstance';\nexport const fetchJobs = async () => {\n  try {\n    const response = await axiosInstance.get('/jobs');\n    if (response.status === 200) {\n      return response.data;\n    } else {\n      throw new Error(`Failed to fetch jobs. Status code: ${response.status}`);\n    }\n  } catch (error) {\n    console.error('Error fetching jobs:', error.message);\n    return []; // Return an empty array to prevent breaking the UI\n  }\n};\nexport const fetchCustomers = async () => {\n  try {\n    const response = await axiosInstance.get('/customers');\n    if (response.status === 200) {\n      return response.data;\n    } else {\n      throw new Error(`Failed to fetch customers. Status code: ${response.status}`);\n    }\n  } catch (error) {\n    console.error('Error fetching customers:', error.message);\n    return [];\n  }\n};\nexport const fetchEmployees = async () => {\n  try {\n    const response = await axiosInstance.get('/employees');\n    if (response.status === 200) {\n      return response.data;\n    } else {\n      throw new Error(`Failed to fetch employees. Status code: ${response.status}`);\n    }\n  } catch (error) {\n    console.error('Error fetching employees:', error.message);\n    return [];\n  }\n};\nexport const fetchAnalytics = async timeRange => {\n  try {\n    const [jobs, customers] = await Promise.all([fetchJobs(), fetchCustomers()]);\n    const endDate = new Date();\n    const startDate = new Date(endDate);\n    startDate.setDate(endDate.getDate() - parseInt(timeRange));\n    const filteredJobs = jobs.filter(job => {\n      const jobDate = new Date(job.date);\n      return jobDate >= startDate && jobDate <= endDate;\n    });\n\n    // Revenue Over Time\n    const revenueOverTime = filteredJobs.reduce((acc, job) => {\n      const date = new Date(job.date).toISOString().split('T')[0]; // YYYY-MM-DD format\n      acc[date] = (acc[date] || 0) + job.price;\n      return acc;\n    }, {});\n\n    // Job Status Distribution\n    const jobStatusDistribution = filteredJobs.reduce((acc, job) => {\n      acc[job.status] = (acc[job.status] || 0) + 1;\n      return acc;\n    }, {});\n\n    // Top Services\n    const topServices = filteredJobs.reduce((acc, job) => {\n      acc[job.serviceType] = (acc[job.serviceType] || 0) + job.price;\n      return acc;\n    }, {});\n\n    // Calculate averages\n    const totalDuration = filteredJobs.reduce((sum, job) => sum + (job.estimatedDuration || 0), 0);\n    const totalRevenue = filteredJobs.reduce((sum, job) => sum + job.price, 0);\n    const averageJobDuration = filteredJobs.length > 0 ? totalDuration / filteredJobs.length : 0;\n    const averageHourlyRate = totalDuration > 0 ? totalRevenue / totalDuration * 60 : 0;\n    return {\n      revenueOverTime: Object.entries(revenueOverTime).map(([date, revenue]) => ({\n        date,\n        revenue\n      })),\n      jobStatusDistribution: {\n        labels: Object.keys(jobStatusDistribution),\n        data: Object.values(jobStatusDistribution)\n      },\n      topServices: {\n        labels: Object.keys(topServices).slice(0, 5),\n        data: Object.values(topServices).slice(0, 5)\n      },\n      averageJobDuration,\n      averageHourlyRate,\n      totalJobs: jobs.length,\n      totalCustomers: customers.length\n    };\n  } catch (error) {\n    console.error('Error fetching analytics:', error.message);\n    throw error; // Re-throw error so it can be handled upstream\n  }\n};","map":{"version":3,"names":["axiosInstance","fetchJobs","response","get","status","data","Error","error","console","message","fetchCustomers","fetchEmployees","fetchAnalytics","timeRange","jobs","customers","Promise","all","endDate","Date","startDate","setDate","getDate","parseInt","filteredJobs","filter","job","jobDate","date","revenueOverTime","reduce","acc","toISOString","split","price","jobStatusDistribution","topServices","serviceType","totalDuration","sum","estimatedDuration","totalRevenue","averageJobDuration","length","averageHourlyRate","Object","entries","map","revenue","labels","keys","values","slice","totalJobs","totalCustomers"],"sources":["C:/AUTOLAWN/autolawn-frontend/src/api/dashboardApi.js"],"sourcesContent":["import axiosInstance from '../utils/axiosInstance';\r\n\r\nexport const fetchJobs = async () => {\r\n  try {\r\n    const response = await axiosInstance.get('/jobs');\r\n    if (response.status === 200) {\r\n      return response.data;\r\n    } else {\r\n      throw new Error(`Failed to fetch jobs. Status code: ${response.status}`);\r\n    }\r\n  } catch (error) {\r\n    console.error('Error fetching jobs:', error.message);\r\n    return []; // Return an empty array to prevent breaking the UI\r\n  }\r\n};\r\n\r\nexport const fetchCustomers = async () => {\r\n  try {\r\n    const response = await axiosInstance.get('/customers');\r\n    if (response.status === 200) {\r\n      return response.data;\r\n    } else {\r\n      throw new Error(`Failed to fetch customers. Status code: ${response.status}`);\r\n    }\r\n  } catch (error) {\r\n    console.error('Error fetching customers:', error.message);\r\n    return [];\r\n  }\r\n};\r\n\r\nexport const fetchEmployees = async () => {\r\n  try {\r\n    const response = await axiosInstance.get('/employees');\r\n    if (response.status === 200) {\r\n      return response.data;\r\n    } else {\r\n      throw new Error(`Failed to fetch employees. Status code: ${response.status}`);\r\n    }\r\n  } catch (error) {\r\n    console.error('Error fetching employees:', error.message);\r\n    return [];\r\n  }\r\n};\r\n\r\nexport const fetchAnalytics = async (timeRange) => {\r\n  try {\r\n    const [jobs, customers] = await Promise.all([fetchJobs(), fetchCustomers()]);\r\n\r\n    const endDate = new Date();\r\n    const startDate = new Date(endDate);\r\n    startDate.setDate(endDate.getDate() - parseInt(timeRange));\r\n\r\n    const filteredJobs = jobs.filter((job) => {\r\n      const jobDate = new Date(job.date);\r\n      return jobDate >= startDate && jobDate <= endDate;\r\n    });\r\n\r\n    // Revenue Over Time\r\n    const revenueOverTime = filteredJobs.reduce((acc, job) => {\r\n      const date = new Date(job.date).toISOString().split('T')[0]; // YYYY-MM-DD format\r\n      acc[date] = (acc[date] || 0) + job.price;\r\n      return acc;\r\n    }, {});\r\n\r\n    // Job Status Distribution\r\n    const jobStatusDistribution = filteredJobs.reduce((acc, job) => {\r\n      acc[job.status] = (acc[job.status] || 0) + 1;\r\n      return acc;\r\n    }, {});\r\n\r\n    // Top Services\r\n    const topServices = filteredJobs.reduce((acc, job) => {\r\n      acc[job.serviceType] = (acc[job.serviceType] || 0) + job.price;\r\n      return acc;\r\n    }, {});\r\n\r\n    // Calculate averages\r\n    const totalDuration = filteredJobs.reduce((sum, job) => sum + (job.estimatedDuration || 0), 0);\r\n    const totalRevenue = filteredJobs.reduce((sum, job) => sum + job.price, 0);\r\n    const averageJobDuration = filteredJobs.length > 0 ? totalDuration / filteredJobs.length : 0;\r\n    const averageHourlyRate = totalDuration > 0 ? (totalRevenue / totalDuration) * 60 : 0;\r\n\r\n    return {\r\n      revenueOverTime: Object.entries(revenueOverTime).map(([date, revenue]) => ({ date, revenue })),\r\n      jobStatusDistribution: {\r\n        labels: Object.keys(jobStatusDistribution),\r\n        data: Object.values(jobStatusDistribution),\r\n      },\r\n      topServices: {\r\n        labels: Object.keys(topServices).slice(0, 5),\r\n        data: Object.values(topServices).slice(0, 5),\r\n      },\r\n      averageJobDuration,\r\n      averageHourlyRate,\r\n      totalJobs: jobs.length,\r\n      totalCustomers: customers.length,\r\n    };\r\n  } catch (error) {\r\n    console.error('Error fetching analytics:', error.message);\r\n    throw error; // Re-throw error so it can be handled upstream\r\n  }\r\n};\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}